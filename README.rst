check_speedtest
=============

Command line interface for testing internet bandwidth using
speedtest.net

.. image:: https://img.shields.io/pypi/v/check_speedtest.svg
        :target: https://pypi.python.org/pypi/check_speedtest/
        :alt: Latest Version
.. image:: https://img.shields.io/travis/slydder/check_speedtest.svg
        :target: https://pypi.python.org/pypi/check_speedtest/
        :alt: Travis
.. image:: https://img.shields.io/pypi/l/check_speedtest.svg
        :target: https://pypi.python.org/pypi/check_speedtest/
        :alt: License

Versions
--------

check_speedtest works with Python 2.4-3.7

.. image:: https://img.shields.io/pypi/pyversions/check_speedtest.svg
        :target: https://pypi.python.org/pypi/check_speedtest/
        :alt: Versions

Installation
------------

Github
~~~~~~

::

    pip install git+https://github.com/slydder/icinga2-check-speedtest.git

or

::

    git clone https://github.com/slydder/icinga2-check-speedtest.git
    cp icinga2-check-speedtest/check_speedtest /usr/lib/nagios/plugins
    chmod 755 /usr/lib/nagios/plugins/check_speedtest

Usage
-----

::

    $ check_speedtest -h
    usage: check_speedtest [-h] [--no-download] [--no-upload] [--single] [--bytes]
                         [--share] [--simple] [--csv]
                         [--csv-delimiter CSV_DELIMITER] [--csv-header] [--json]
                         [--list] [--server SERVER] [--exclude EXCLUDE]
                         [--mini MINI] [--source SOURCE] [--timeout TIMEOUT]
                         [--secure] [--no-pre-allocate] [--version] [-w 400|30]
                         [-c 10|2]

    Command line interface for testing internet bandwidth using speedtest.net.
    --------------------------------------------------------------------------
    https://github.com/slydder/check_speedtest

    optional arguments:
      -h, --help            show this help message and exit
      --no-download         Do not perform download test
      --no-upload           Do not perform upload test
      --single              Only use a single connection instead of multiple. This
                            simulates a typical file transfer.
      --bytes               Display values in bytes instead of bits. Does not
                            affect the image generated by --share, nor output from
                            --json or --csv
      --share               Generate and provide a URL to the speedtest.net share
                            results image, not displayed with --csv
      --simple              Suppress verbose output, only show basic information
      --csv                 Suppress verbose output, only show basic information
                            in CSV format. Speeds listed in bit/s and not affected
                            by --bytes
      --csv-delimiter CSV_DELIMITER
                            Single character delimiter to use in CSV output.
                            Default ","
      --csv-header          Print CSV headers
      --json                Suppress verbose output, only show basic information
                            in JSON format. Speeds listed in bit/s and not
                            affected by --bytes
      --list                Display a list of speedtest.net servers sorted by
                            distance
      --server SERVER       Specify a server ID to test against. Can be supplied
                            multiple times
      --exclude EXCLUDE     Exclude a server from selection. Can be supplied
                            multiple times
      --mini MINI           URL of the Speedtest Mini server
      --source SOURCE       Source IP address to bind to
      --timeout TIMEOUT     HTTP timeout in seconds. Default 10
      --secure              Use HTTPS instead of HTTP when communicating with
                            speedtest.net operated servers
      --no-pre-allocate     Do not pre allocate upload data. Pre allocation is
                            enabled by default to improve upload performance. To
                            support systems with insufficient memory, use this
                            option to avoid a MemoryError
      --version             Show the version number and exit
      -w 400|30, --warning 400|30
                            Warning limits for Download|Upload given in Mbit's.
                            ex. 300|40
      -c 10|2, --critical 10|2
                            Critical limits for Download|Upload given in Mbit's.
                            ex. 100|20


Python API
----------

See the `wiki <https://github.com/slydder/icinga2-check-speedtest/wiki>`_.


Inconsistency
-------------

It is not a goal of this application to be a reliable latency reporting tool.

Latency reported by this tool should not be relied on as a value indicative of ICMP
style latency. It is a relative value used for determining the lowest latency server
for performing the actual speed test against.

There is the potential for this tool to report results inconsistent with Speedtest.net.
There are several concepts to be aware of that factor into the potential inconsistency:

1. Speedtest.net has migrated to using pure socket tests instead of HTTP based tests
2. This application is written in Python
3. Different versions of Python will execute certain parts of the code faster than others
4. CPU and Memory capacity and speed will play a large part in inconsistency between
   Speedtest.net and even other machines on the same network

Issues relating to inconsistencies will be closed as wontfix and without
additional reason or context.
